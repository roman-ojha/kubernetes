*) Here we will deploy two application:
    1. MongoDB
    2. mongo-express
    -> you can reference the repo: https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/demo-kubernetes-components
    
*) Steps:
    1. First we will create MongoDB Pod
        ->  In order to Talk to that Pod we need to create Service and we will going to create and Internal Service it's means that No external requests are allowed to the Pod only Components inside the same cluster can talk to it. './02_MongoDB_Application.png'
    2. Then we will going to create "Mongo Express" Deployment './
        -> One we will going to need DB URL of MongoDB so that "Mongo Express" can connect to it.
        -> Second one is Credentials like 'username' & 'password' of that MongoDb for the authenticate
        -> so the way we can pass this information is through "Mongo Express" through it's Deployment configuration file through Environment Variables
        -> So we will going to create ConfigMap that will going to contain DB Url and we will going to create Secret that contain the Credentials and we will going to reference both on that deployment file
    3. After that we will going to need "Mongo Express" to be accessible to the browser For that we will going to create a External Service, that will allow extern request to talk to the Pod.
        -> './04_External_Service_for_Mongo_Express.png'
        -> So the URL will be:
            - Ip address of Node
            -> Port of External Service
            
*) Secret Configuration File:
    -> './06_Secret_Configuration_File.png'
    -> it contain the Credentials that you don't want to store in repository
    -> NOTE that The value would be in plain text but will be in base64 incoded
    -> Storing the data in Secret component doesn't automatically make it secure
    -> There are build-in mechanism (like encryption) for basic security, which are not enable by default.
    
    -> To get the encoded value from the terminal:
        -> echo -n '<value>' | base64
        -> EX: echo -n 'username' | base64
                -> dXNlcm5hbWUNCg==
            echo -n 'password' | base64
                -> cGFzc3dvcmQNCg==

    -> NOTE: we have to create secret before the Deployment if we want to reference the secret inside of the deployment configuration file

    *) Create Secret:
        -> kubectl apply -f .\<Secret_file_name>.yaml
            -> EX: kubectl apply -f .\mongo-secret.yaml
            
        -> kubectl get secret
            -> (Now we can get list of secret that we have crated)
            

    -> Now we can created secret we can referenced inside Deployment configuration file
    -> after that we can create the deployment:
        -> kubectl apply -f .\mongo.yaml

    !‚ùØ kubectl get all
        NAME                                      READY   STATUS    RESTARTS   AGE
        pod/mongodb-deployment-84d7c8b6dd-8fm62   1/1     Running   0          37s

        NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
        service/kubernetes   ClusterIP   10.96.0.1    <none>        443/TCP   3h47m

        NAME                                 READY   UP-TO-DATE   AVAILABLE   AGE
        deployment.apps/mongodb-deployment   1/1     1            1           37s

        NAME                                            DESIRED   CURRENT   READY   AGE
        replicaset.apps/mongodb-deployment-84d7c8b6dd   1         1         1       37s


*) Creating Internal Service
    -> We have create MongoDB service inside same configuration file './mongo.yaml'
    -> kubectl apply -f .\mongo.yaml

    -> kubectl get all | grep <name_of_component>
        (If you want to get all the component information for specific deployment)
        -> EX: kubectl get all | grep mongodb
            pod/mongodb-deployment-84d7c8b6dd-w47pl   1/1     Running   0          2m53s
            service/mongodb-service   ClusterIP   10.105.168.215   <none>        27017/TCP   2m53s
            deployment.apps/mongodb-deployment   1/1     1            1           2m53s
            replicaset.apps/mongodb-deployment-84d7c8b6dd   1         1         1       2m53s
            
*) Creating ConfigMap for External Configuration:
    -> https://kubernetes.io/docs/concepts/configuration/configmap/#configmaps-and-pods
    -> './09_ConfigMap.png'
    -> Defined inside './mongo-configmap.yaml'
    -> Used inside './mongo-express.yaml'
    
    -> NOTE that same as secret the order of execution of create matters here as well. So, we have to have Config Map already bin in the K8s cluster, when referencing it in other configuration.

    -> kubectl get configMap
        -> (command to get the list of created configMap)

*) Create "Mongo Express" Deployment & Service 
    *) Deployment
        -> for the deployment we have defined here: './mongo-express.yaml' 
    *) Service:
        -> './11_External_Service.png'
        -> to access the application on the browser we need to create the external service
        -> https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/#create-a-service
        -> For that we will going to need External Services
        *) How to make it an External Service:
            1. -type: LoadBalancer
                -> this is the to make service as external service because internal service will also act as LoadBalancer
                -> so this 'LoadBalancer' type does is it accept external request by assigning the service an external Ip address
            2. nodePort: <port>
                -> https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport
                -> another this that we will use to make it external service is by providing the third port
                -> so this is the port where external ip address will be open
                -> so this is the port that we have to put in browser to access this service 
                -> and the nodePort must be between: 30000 - 32767
                
        !‚ùØ kubectl get services
            NAME                    TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
            kubernetes              ClusterIP      10.96.0.1        <none>        443/TCP          5h7m
            mongo-express-service   LoadBalancer   10.111.75.188    <pending>     8081:30000/TCP   15s
            mongodb-service         ClusterIP      10.105.168.215   <none>        27017/TCP        68m
            -> here we can see that 'mongo-express-service' is 'LoadBalancer' type
            -> so 'ClusterIP' the internal service which is Default
            -> here we can see that 'ClusterIP' gives and internal Ip address 'CLUSTER-IP' and 'LoadBalancer' also given the internal Ip address 
            -> But 'LoadBalancer' will also give it an External Ip address 'EXTERNAL-IP' where in this case it is saying '<pending>' because in minikube it work little differently but in regular kubernetes setup you would see actual Ip address
            -> And also in internal Service you will only have one port, but in case of External Service you would have Port for both of them in this case "8081:30000/TCP"

        -> To provide the external IP address for External Service in Minikube like this:
            -> minikube service <name_of_the_service>
                -> EX: minikube service mongo-express-service
                    |-----------|-----------------------|-------------|-----------------------------|
                    | NAMESPACE |         NAME          | TARGET PORT |             URL             |
                    |-----------|-----------------------|-------------|-----------------------------|
                    | default   | mongo-express-service |        8081 | http://172.29.160.189:30000 |
                    |-----------|-----------------------|-------------|-----------------------------|
                    üéâ  Opening service default/mongo-express-service in default browser...
                -> Here it is providing the external Ip address with port to access the service